<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê°•ë‚¨êµ¬ ê³ ë„ ì§€ë„ | Gangnam-gu Elevation Map</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
#map { width: 100%; height: 100vh; }

.info-panel {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 1000;
  background: rgba(255,255,255,0.95);
  border-radius: 12px;
  padding: 16px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  max-width: 280px;
  font-size: 14px;
}
.info-panel h2 {
  font-size: 16px;
  margin-bottom: 8px;
  color: #333;
}
.info-panel p {
  color: #666;
  line-height: 1.5;
  margin-bottom: 6px;
}

.elevation-display {
  position: absolute;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1000;
  background: rgba(0,0,0,0.8);
  color: #fff;
  border-radius: 8px;
  padding: 10px 20px;
  font-size: 15px;
  font-weight: 500;
  display: none;
  white-space: nowrap;
}

.legend {
  position: absolute;
  bottom: 30px;
  right: 10px;
  z-index: 1000;
  background: rgba(255,255,255,0.95);
  border-radius: 10px;
  padding: 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  font-size: 12px;
}
.legend h4 { margin-bottom: 6px; font-size: 13px; }
.legend-item {
  display: flex;
  align-items: center;
  margin-bottom: 3px;
}
.legend-color {
  width: 24px;
  height: 14px;
  border-radius: 3px;
  margin-right: 6px;
  border: 1px solid rgba(0,0,0,0.1);
}

.layer-control {
  position: absolute;
  top: 10px;
  left: 60px;
  z-index: 1000;
  background: rgba(255,255,255,0.95);
  border-radius: 10px;
  padding: 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  font-size: 13px;
}
.layer-control label {
  display: block;
  margin-bottom: 4px;
  cursor: pointer;
}
.layer-control input { margin-right: 6px; }
</style>
</head>
<body>

<div id="map"></div>

<div class="info-panel">
  <h2>ğŸ”ï¸ ê°•ë‚¨êµ¬ ê³ ë„ ì§€ë„</h2>
  <p>ë“±ê³ ì„ ê³¼ ìŒì˜ê¸°ë³µì´ í‘œì‹œëœ ê°•ë‚¨êµ¬ ì§€í˜•ë„ì…ë‹ˆë‹¤.</p>
  <p>ğŸ–±ï¸ ì§€ë„ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ì§€ì ì˜ ê³ ë„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  <p style="font-size:12px;color:#999;">ë°ì´í„°: OpenTopoMap, OpenStreetMap, Open-Elevation API</p>
</div>

<div class="layer-control">
  <strong>ğŸ—ºï¸ ë ˆì´ì–´</strong>
  <label><input type="radio" name="base" value="topo" checked> ë“±ê³ ì„  ì§€í˜•ë„</label>
  <label><input type="radio" name="base" value="osm"> ì¼ë°˜ ì§€ë„</label>
  <label><input type="radio" name="base" value="satellite"> ìœ„ì„± ì§€ë„</label>
  <hr style="margin:6px 0">
  <label><input type="checkbox" id="hillshade" checked> ìŒì˜ê¸°ë³µ (Hillshade)</label>
  <label><input type="checkbox" id="contours" checked> ë“±ê³ ì„  ê°•ì¡°</label>
  <label><input type="checkbox" id="markers" checked> ì£¼ìš” ì–¸ë• ë§ˆì»¤</label>
</div>

<div class="elevation-display" id="elevationDisplay"></div>

<div class="legend">
  <h4>ê³ ë„ ë²”ìœ„</h4>
  <div class="legend-item"><div class="legend-color" style="background:#1a9850"></div> 0~20m (ì €ì§€ëŒ€)</div>
  <div class="legend-item"><div class="legend-color" style="background:#91cf60"></div> 20~40m</div>
  <div class="legend-item"><div class="legend-color" style="background:#d9ef8b"></div> 40~60m</div>
  <div class="legend-item"><div class="legend-color" style="background:#fee08b"></div> 60~100m</div>
  <div class="legend-item"><div class="legend-color" style="background:#fc8d59"></div> 100~150m</div>
  <div class="legend-item"><div class="legend-color" style="background:#d73027"></div> 150m+ (ê³ ì§€ëŒ€)</div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// Gangnam-gu bounds
const gangnamCenter = [37.4975, 127.0475];
const gangnamBounds = [[37.464, 127.012], [37.532, 127.105]];

// Base layers
const topoLayer = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
  maxZoom: 17,
  attribution: 'Â© OpenTopoMap (CC-BY-SA)'
});

const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: 'Â© OpenStreetMap contributors'
});

const satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
  maxZoom: 18,
  attribution: 'Â© Esri'
});

// Hillshade overlay - using Thunderforest-like or Stamen terrain
const hillshadeLayer = L.tileLayer('https://tiles.wmflabs.org/hillshading/{z}/{x}/{y}.png', {
  maxZoom: 17,
  opacity: 0.45,
  attribution: 'Â© Hillshading SRTM'
});

// Contour overlay (OpenTopoMap on top of other bases for contour lines)
const contourOverlay = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
  maxZoom: 17,
  opacity: 0.35,
  attribution: ''
});

// Init map
const map = L.map('map', {
  center: gangnamCenter,
  zoom: 14,
  layers: [topoLayer, hillshadeLayer]
});

// Gangnam-gu boundary highlight
const gangnamOutline = L.rectangle(gangnamBounds, {
  color: '#e74c3c',
  weight: 2,
  fill: false,
  dashArray: '8,4',
  opacity: 0.6
}).addTo(map);

// Notable hills/elevated areas in Gangnam-gu
const hills = [
  { name: 'ëŒ€ëª¨ì‚° (å¤§æ¯å±±)', lat: 37.4730, lng: 127.0830, elev: '293m', desc: 'ê°•ë‚¨êµ¬ ìµœê³ ë´‰, ìˆ˜ì„œë™' },
  { name: 'êµ¬ë£¡ì‚° (ä¹é¾å±±)', lat: 37.4785, lng: 127.0620, elev: '306m', desc: 'ê°œí¬ë™, ë“±ì‚°ë¡œ ì¸ê¸°' },
  { name: 'ìš°ë©´ì‚° (ç‰›çœ å±±)', lat: 37.4780, lng: 127.0080, elev: '293m', desc: 'ì„œì´ˆêµ¬ ê²½ê³„, ì˜ˆìˆ ì˜ì „ë‹¹ ë’¤' },
  { name: 'ë§¤ë´‰ì‚°', lat: 37.4910, lng: 127.0450, elev: '101m', desc: 'ë„ê³¡ë™, ë§¤ë´‰ì—­ ì¸ê·¼' },
  { name: 'ë‹¬í„°ê·¼ë¦°ê³µì›', lat: 37.5080, lng: 127.0520, elev: '60m', desc: 'ì‚¼ì„±ë™ ì–¸ë•' },
  { name: 'ì–¸ì£¼ë¡œ ì¼ëŒ€ (ì—­ì‚¼ë™ ì–¸ë•)', lat: 37.5010, lng: 127.0380, elev: '45m', desc: 'ì—­ì‚¼ë™ ë‚´ êµ¬ë¦‰ì§€' },
  { name: 'ì¼ì›ë™ êµ¬ë¦‰ì§€', lat: 37.4830, lng: 127.0900, elev: '80m', desc: 'ì‚¼ì„±ì„œìš¸ë³‘ì› ì¸ê·¼ ê³ ì§€ëŒ€' },
  { name: 'ì„¸ê³¡ë™ êµ¬ë¦‰', lat: 37.4680, lng: 127.0700, elev: '120m', desc: 'ì„¸ê³¡ë™ ë‚¨ë¶€ êµ¬ë¦‰' },
  { name: 'ìˆ˜ì„œë™ ê³ ì§€ëŒ€', lat: 37.4870, lng: 127.1010, elev: '90m', desc: 'SRTìˆ˜ì„œì—­ ë™ìª½ ì–¸ë•' },
];

const hillIcon = L.divIcon({
  html: 'â›°ï¸',
  className: 'hill-marker',
  iconSize: [24, 24],
  iconAnchor: [12, 12]
});

const markerGroup = L.layerGroup();
hills.forEach(h => {
  const marker = L.marker([h.lat, h.lng], { icon: hillIcon })
    .bindPopup(`<strong>${h.name}</strong><br>ê³ ë„: ${h.elev}<br>${h.desc}`);
  markerGroup.addLayer(marker);
});
markerGroup.addTo(map);

// Layer switching
const baseLayers = { topo: topoLayer, osm: osmLayer, satellite: satelliteLayer };
let currentBase = 'topo';

document.querySelectorAll('input[name="base"]').forEach(radio => {
  radio.addEventListener('change', e => {
    map.removeLayer(baseLayers[currentBase]);
    currentBase = e.target.value;
    map.addLayer(baseLayers[currentBase]);
    // Show contour overlay on non-topo bases
    const contourCheckbox = document.getElementById('contours');
    if (currentBase !== 'topo' && contourCheckbox.checked) {
      if (!map.hasLayer(contourOverlay)) map.addLayer(contourOverlay);
    } else {
      if (map.hasLayer(contourOverlay)) map.removeLayer(contourOverlay);
    }
  });
});

document.getElementById('hillshade').addEventListener('change', e => {
  e.target.checked ? map.addLayer(hillshadeLayer) : map.removeLayer(hillshadeLayer);
});

document.getElementById('contours').addEventListener('change', e => {
  if (currentBase !== 'topo') {
    e.target.checked ? map.addLayer(contourOverlay) : map.removeLayer(contourOverlay);
  }
});

document.getElementById('markers').addEventListener('change', e => {
  e.target.checked ? map.addLayer(markerGroup) : map.removeLayer(markerGroup);
});

// Click to get elevation
const elevDisplay = document.getElementById('elevationDisplay');
let elevMarker = null;

map.on('click', async (e) => {
  const { lat, lng } = e.latlng;
  elevDisplay.style.display = 'block';
  elevDisplay.textContent = 'â³ ê³ ë„ ì¡°íšŒ ì¤‘...';

  if (elevMarker) map.removeLayer(elevMarker);
  elevMarker = L.circleMarker([lat, lng], {
    radius: 6, color: '#e74c3c', fillColor: '#e74c3c', fillOpacity: 0.8
  }).addTo(map);

  try {
    const res = await fetch(`https://api.open-elevation.com/api/v1/lookup?locations=${lat},${lng}`);
    const data = await res.json();
    const elev = data.results[0].elevation;
    elevDisplay.textContent = `ğŸ“ ${lat.toFixed(5)}, ${lng.toFixed(5)} â€” ê³ ë„: ${elev}m`;
    elevDisplay.style.display = 'block';
  } catch {
    elevDisplay.textContent = `ğŸ“ ${lat.toFixed(5)}, ${lng.toFixed(5)} â€” ê³ ë„ ì¡°íšŒ ì‹¤íŒ¨ (API ì œí•œ)`;
  }
});

// Fit to Gangnam area
map.fitBounds(gangnamBounds, { padding: [20, 20] });
</script>
</body>
</html>
